# java8

## JVM 内存结构

<!-- notecardId: 1735050991861 -->

Java 虚拟机（JVM）内存结构主要分为以下几个部分：

1. **程序计数器**：程序计数器是一块较小的内存区域，用于记录当前线程所执行的字节码的行号指示器。每个线程都有一个独立的程序计数器，线程切换时能够恢复到正确的执行位置。

2. **Java 虚拟机栈**：每个线程都有一个独立的虚拟机栈，用于存储局部变量、操作数栈、动态链接、方法出口等信息。每个方法在执行时都会创建一个栈帧，用于存储方法的局部变量表、操作数栈、动态链接和方法出口等信息。

3. **本地方法栈**：本地方法栈与虚拟机栈类似，只不过它为虚拟机使用到的本地方法服务。它也是线程私有的。

4. **堆**：堆是所有线程共享的一块内存区域，用于存储对象实例。堆是垃圾收集器管理的主要区域，因此也被称为“GC 堆”。根据垃圾收集的需要，堆可以进一步细分为新生代和老年代等。

5. **方法区**：方法区也是所有线程共享的内存区域，用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。方法区在很多情况下也被称为“永久代”，但在 JDK 8 之后，永久代被移除，取而代之的是元空间（Metaspace）。

6. **运行时常量池**：运行时常量池是方法区的一部分，用于存放编译期生成的各种字面量和符号引用。运行时常量池具有动态性，运行期间也可以将新的常量放入池中。

7. **直接内存**：直接内存并不是 JVM 运行时数据区的一部分，但也被频繁使用。它是在 Java 中通过 `NIO`（New Input/Output）库来分配的，使用本地方法直接分配堆外内存。

这些内存区域共同构成了 JVM 的内存结构，确保 Java 程序能够高效、稳定地运行。

> <https://doocs.github.io/jvm/01-jvm-memory-structure.html>
